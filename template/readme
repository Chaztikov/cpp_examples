why not use valarray?

see

